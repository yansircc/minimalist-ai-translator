## 项目概述

- **项目目标**：开发一个类似 DeepL 的简单翻译 App，前端页面设计尽量简洁，支持快捷键操作。核心特色在于：

  - **输入方式区分**：

    - 当用户通过复制粘贴方式输入（判断依据：超过 3 个单词或 4 个汉字），则自动触发翻译，无需用户按下回车；
    - 当用户手动输入时，则需要用户按下回车来触发翻译，且支持 Shift+Enter 换行。

- **技术栈**：

  - Next.js 15
  - Tailwind CSS
  - shadcn（UI 组件库）
  - Vercel AI SDK（类似 OpenAI API 封装，作为翻译 API 的调用接口）

- **CI/CD**：使用 GitHub Actions 实现自动化测试、构建、以及部署（部署目标为 Vercel）。

---

## 阶段划分与任务详情

### 阶段 1：需求分析 & 项目规划

- **需求确认**：

  - 明确 App 功能（输入检测、翻译展示、自动/手动触发逻辑、快捷键支持）。
  - 确定界面风格（极简风格）以及用户体验细节（例如输入框、翻译结果展示区、加载状态等）。

- **架构设计**：

  - 前端架构：基于 Next.js 构建，页面组件化，使用 Tailwind CSS + shadcn 构建 UI 组件。
  - 后端/服务层：使用 Vercel AI SDK 封装翻译 API 的调用逻辑，可选择在 Next.js 的 API 路由中封装。

- **技术预研**：

  - 学习 Vercel AI SDK 的使用方式与调用参数。
  - 调研如何实现输入检测（复制粘贴 vs 手动输入）及快捷键处理。

### 阶段 2：项目初始化 & 环境搭建

- **项目初始化**：

  - 使用 Next.js 15 脚手架创建新项目。
  - 配置 Tailwind CSS 与 shadcn UI 组件库（可参考官方文档，配置 PostCSS、purge 等）。

- **版本控制与目录规划**：

  - 初始化 Git 仓库，合理规划目录结构。

- **本地开发环境搭建**：

  - 配置 ESLint、Prettier 等代码格式化和检查工具。
  - 编写初步的 README 与开发文档，明确开发流程。

### 阶段 3：核心功能开发 — 用户界面 & 输入处理

- **界面设计**：

  - 设计一个简洁的主页面，包含：

    - **输入区域**：支持多行输入（textarea 或自定义编辑器组件）。
    - **翻译结果展示区**：清晰展示翻译内容、加载状态及错误信息。
    - **简洁的状态提示**：甚至不应该有按钮，需要极简的 UI 设计，比如在电脑上就是左右分屏，在手机上就是上下分屏。

- **快捷键与输入逻辑**：

  - **键盘事件处理**：

    - 监听 `onKeyDown` 事件，在输入框中实现：

      - **Enter 键**：检测是否为手动输入，若是则触发翻译。
      - **Shift+Enter**：插入换行，不触发翻译。

  - **复制粘贴检测**：

    - 监听 `onPaste` 事件：

      - 判断粘贴内容是否超过 3 个单词或 4 个汉字；
      - 若超过阈值，自动触发翻译，无需等待回车。

  - **输入状态判断**：
    - 使用内部状态（例如 React 的 state）区分用户粘贴与手动输入，避免误触发。
    - 如果需要状态管理，可以考虑使用 zustand 或者 useReducer。

- **UI 组件开发**：

  - 使用 shadcn 提供的组件或者自定义 Tailwind CSS 样式组件来构建输入框和结果展示区。
  - 保证 UI 的响应速度、兼容性和极简美观。

### 阶段 4：翻译服务的接入与业务逻辑实现

- **Vercel AI SDK 集成**：

  - 封装一个翻译服务模块（应该是一个server action），用来处理前端的翻译任务。

- **业务逻辑**：

  - 实现输入触发后的异步翻译调用，并在 UI 上反馈加载状态、结果展示以及错误处理。
  - 根据用户的输入方式（粘贴 vs 手动）分别触发翻译逻辑，确保业务流程顺畅。

### 阶段 5：CI/CD 集成与自动化测试

- **单元测试与集成测试**：

  - 使用 Bun test 对核心组件、输入逻辑、服务器组件等调用等进行测试。
  - 使用 cypress 对前端页面进行测试。

  - 测试重点：

    - 输入检测逻辑（粘贴内容自动翻译、手动输入按回车翻译、Shift+Enter 换行）。
    - 翻译 API 调用及返回结果的展示逻辑。

- **GitHub Actions 配置**：

  - 创建 `.github/workflows/ci.yml` 文件，包含以下步骤：

    - **Lint 检查**：运行 ESLint 检查代码格式。
    - **单元测试**：运行 buntest 测试，确保所有测试用例通过。
    - **构建项目**：执行 Next.js 的构建命令（如 `next build`）。
    - **部署触发**：构建成功后，触发部署到 Vercel 的流程（或由 Vercel 直接集成 GitHub 自动部署）。

- **持续集成部署**：
  - 与 Vercel 账号关联，设置 GitHub 与 Vercel 的自动部署（每次 push 自动构建部署）。

### 阶段 6：部署、调试与发布

- **部署前测试**：

  - 在 Vercel 上部署预览版本，进行端到端测试，确保所有功能在真实环境中正常运作。
  - 调试 UI 兼容性、网络请求、输入事件等问题。

- **发布与文档**：

  - 更新 README、用户文档以及开发文档，确保团队与用户能够顺利使用与维护此 App。
  - 配置错误监控、日志收集等，便于后续维护和问题追踪。
